<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:PRPR.BooruViewer.Views"
    xmlns:Control="using:PRPR.ExReader.Controls"
    xmlns:CommonControls="using:PRPR.Common.Views.Controls"
    xmlns:Controls="using:PRPR.BooruViewer.Controls"
    xmlns:CommonConverters="using:PRPR.Common.Converters"
    xmlns:Converters="using:PRPR.BooruViewer.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ViewModels="using:PRPR.BooruViewer.ViewModels"
    x:Class="PRPR.BooruViewer.Views.HomePage"
    mc:Ignorable="d"
    NavigationCacheMode="Required"
    Loaded="Page_Loaded"
    >

    <Page.DataContext>
        <ViewModels:HomeViewModel/>
    </Page.DataContext>

    <Page.Resources>

        <CommonConverters:RandomGrayConverter x:Key="RandomGrayConverter"/>
        <Converters:TagTypeSymbolConverter x:Key="TagTypeSymbolConverter"/>

        <Converters:TagTypeColorConverter x:Key="TagTypeColorConverter"/>


        <Style x:Key="FlipViewStyle1" TargetType="FlipView">
            <!--<Setter Property="Background" Value="{ThemeResource SystemControlPageBackgroundListLowBrush}"/>-->
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="Black"/>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="TabNavigation" Value="Once"/>
            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Hidden"/>
            <Setter Property="ScrollViewer.IsHorizontalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.IsVerticalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.IsHorizontalScrollChainingEnabled" Value="True"/>
            <Setter Property="ScrollViewer.IsVerticalScrollChainingEnabled" Value="True"/>
            <Setter Property="ScrollViewer.IsDeferredScrollingEnabled" Value="False"/>
            <Setter Property="ScrollViewer.BringIntoViewOnFocusChange" Value="True"/>
            <Setter Property="UseSystemFocusVisuals" Value="True"/>
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel AreScrollSnapPointsRegular="True" Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="FlipView">
                        <Grid BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                            <Grid.Resources>
                                <ControlTemplate x:Key="HorizontalNextTemplate" TargetType="Button">
                                    <Border x:Name="Root" BorderBrush="{ThemeResource SystemControlForegroundTransparentBrush}" BorderThickness="{ThemeResource FlipViewButtonBorderThemeThickness}" Background="{ThemeResource SystemControlBackgroundBaseMediumLowBrush}">
                                        <VisualStateManager.VisualStateGroups>
                                            <VisualStateGroup x:Name="CommonStates">
                                                <VisualState x:Name="Normal"/>
                                                <VisualState x:Name="PointerOver">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                                <VisualState x:Name="Pressed">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                            </VisualStateGroup>
                                        </VisualStateManager.VisualStateGroups>
                                        <FontIcon x:Name="Arrow" Foreground="{ThemeResource SystemControlForegroundAltMediumHighBrush}" FontSize="12" FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE0E3;" HorizontalAlignment="Center" MirroredWhenRightToLeft="True" UseLayoutRounding="False" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                                <ControlTemplate x:Key="HorizontalPreviousTemplate" TargetType="Button">
                                    <Border x:Name="Root" BorderBrush="{ThemeResource SystemControlForegroundTransparentBrush}" BorderThickness="{ThemeResource FlipViewButtonBorderThemeThickness}" Background="{ThemeResource SystemControlBackgroundBaseMediumLowBrush}">
                                        <VisualStateManager.VisualStateGroups>
                                            <VisualStateGroup x:Name="CommonStates">
                                                <VisualState x:Name="Normal"/>
                                                <VisualState x:Name="PointerOver">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                                <VisualState x:Name="Pressed">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                            </VisualStateGroup>
                                        </VisualStateManager.VisualStateGroups>
                                        <FontIcon x:Name="Arrow" Foreground="{ThemeResource SystemControlForegroundAltMediumHighBrush}" FontSize="12" FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE0E2;" HorizontalAlignment="Center" MirroredWhenRightToLeft="True" UseLayoutRounding="False" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                                <ControlTemplate x:Key="VerticalNextTemplate" TargetType="Button">
                                    <Border x:Name="Root" BorderBrush="{ThemeResource SystemControlForegroundTransparentBrush}" BorderThickness="{ThemeResource FlipViewButtonBorderThemeThickness}" Background="{ThemeResource SystemControlBackgroundBaseMediumLowBrush}">
                                        <VisualStateManager.VisualStateGroups>
                                            <VisualStateGroup x:Name="CommonStates">
                                                <VisualState x:Name="Normal"/>
                                                <VisualState x:Name="PointerOver">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                                <VisualState x:Name="Pressed">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                            </VisualStateGroup>
                                        </VisualStateManager.VisualStateGroups>
                                        <FontIcon x:Name="Arrow" Foreground="{ThemeResource SystemControlForegroundAltMediumHighBrush}" FontSize="12" FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE0E5;" HorizontalAlignment="Center" UseLayoutRounding="False" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                                <ControlTemplate x:Key="VerticalPreviousTemplate" TargetType="Button">
                                    <Border x:Name="Root" BorderBrush="{ThemeResource SystemControlForegroundTransparentBrush}" BorderThickness="{ThemeResource FlipViewButtonBorderThemeThickness}" Background="{ThemeResource SystemControlBackgroundBaseMediumLowBrush}">
                                        <VisualStateManager.VisualStateGroups>
                                            <VisualStateGroup x:Name="CommonStates">
                                                <VisualState x:Name="Normal"/>
                                                <VisualState x:Name="PointerOver">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                                <VisualState x:Name="Pressed">
                                                    <Storyboard>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="Root">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="Arrow">
                                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltAltMediumHighBrush}"/>
                                                        </ObjectAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </VisualState>
                                            </VisualStateGroup>
                                        </VisualStateManager.VisualStateGroups>
                                        <FontIcon x:Name="Arrow" Foreground="{ThemeResource SystemControlForegroundAltMediumHighBrush}" FontSize="12" FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE0E4;" HorizontalAlignment="Center" UseLayoutRounding="False" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Grid.Resources>
                            <ScrollViewer x:Name="ScrollingHost" AutomationProperties.AccessibilityView="Raw" BringIntoViewOnFocusChange="{TemplateBinding ScrollViewer.BringIntoViewOnFocusChange}" HorizontalScrollMode="{TemplateBinding ScrollViewer.HorizontalScrollMode}" HorizontalSnapPointsType="MandatorySingle" HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}" IsTabStop="False" IsHorizontalRailEnabled="{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}" IsHorizontalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsHorizontalScrollChainingEnabled}" IsVerticalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsVerticalScrollChainingEnabled}" IsVerticalRailEnabled="{TemplateBinding ScrollViewer.IsVerticalRailEnabled}" IsDeferredScrollingEnabled="{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}" Padding="{TemplateBinding Padding}" TabNavigation="{TemplateBinding TabNavigation}" VerticalSnapPointsType="MandatorySingle" VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}" VerticalScrollMode="{TemplateBinding ScrollViewer.VerticalScrollMode}" ZoomMode="Disabled" ViewChanged="ScrollingHost_ViewChanged"
                                          >
                                <ItemsPresenter/>
                            </ScrollViewer>
                            <!--<Button x:Name="PreviousButtonHorizontal" HorizontalAlignment="Left" Height="36" IsTabStop="False" Template="{StaticResource HorizontalPreviousTemplate}" UseSystemFocusVisuals="False" VerticalAlignment="Center" Width="20"/>
                            <Button x:Name="NextButtonHorizontal" HorizontalAlignment="Right" Height="36" IsTabStop="False" Template="{StaticResource HorizontalNextTemplate}" UseSystemFocusVisuals="False" VerticalAlignment="Center" Width="20"/>
                            <Button x:Name="PreviousButtonVertical" HorizontalAlignment="Center" Height="20" IsTabStop="False" Template="{StaticResource VerticalPreviousTemplate}" UseSystemFocusVisuals="False" VerticalAlignment="Top" Width="36"/>
                            <Button x:Name="NextButtonVertical" HorizontalAlignment="Center" Height="20" IsTabStop="False" Template="{StaticResource VerticalNextTemplate}" UseSystemFocusVisuals="False" VerticalAlignment="Bottom" Width="36"/>-->
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        
        <Flyout Placement="Bottom" x:Key="FilterMainFlyout">
            <Flyout.FlyoutPresenterStyle>
                <Style TargetType="FlyoutPresenter">
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Margin" Value="0"/>
                </Style>
            </Flyout.FlyoutPresenterStyle>
            <StackPanel Width="300">
                <StackPanel.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromHorizontalOffset="-56"/>
                    </TransitionCollection>
                </StackPanel.Transitions>

                <ListViewItem HorizontalContentAlignment="Stretch" Tapped="MenuFlyoutSubItem_Tapped">
                    <Grid>
                        <TextBlock Text="評級" VerticalAlignment="Center"/>
                        <FontIcon HorizontalAlignment="Right"
                                  Glyph="&#xE0E3;"
                                  FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                  FontSize="12"
                                  AutomationProperties.AccessibilityView="Raw"
                                  Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                                  Margin="36,15,0,17" 
                                  MirroredWhenRightToLeft="True" />
                    </Grid>
                </ListViewItem>


                <ListViewItem HorizontalContentAlignment="Stretch" Tapped="ListViewItem_Tapped">
                    <Grid>
                        <TextBlock Text="長闊比" VerticalAlignment="Center"/>
                        <FontIcon HorizontalAlignment="Right"
                                  Glyph="&#xE0E3;"
                                  FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                  FontSize="12"
                                  AutomationProperties.AccessibilityView="Raw"
                                  Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                                  Margin="36,15,0,17" 
                                  MirroredWhenRightToLeft="True" />
                    </Grid>
                </ListViewItem>

                <ListViewItem HorizontalContentAlignment="Stretch" Tapped="FilterHiddenPostsListViewItem_Tapped">
                    <Grid>
                        <TextBlock Text="隱藏圖片" VerticalAlignment="Center"/>
                        <FontIcon HorizontalAlignment="Right"
                                  Glyph="&#xE0E3;"
                                  FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                  FontSize="12"
                                  AutomationProperties.AccessibilityView="Raw"
                                  Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                                  Margin="36,15,0,17" 
                                  MirroredWhenRightToLeft="True" />
                    </Grid>
                </ListViewItem>
            </StackPanel>
        </Flyout>

        <Flyout Placement="Bottom" x:Key="FilterRatingFlyout">
            <Flyout.FlyoutPresenterStyle>
                <Style TargetType="FlyoutPresenter">
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Margin" Value="0"/>
                </Style>
            </Flyout.FlyoutPresenterStyle>

            <StackPanel Width="300" Padding="12,0,12,12">
                <StackPanel.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromHorizontalOffset="56"/>
                    </TransitionCollection>
                </StackPanel.Transitions>
                <ListViewItem HorizontalContentAlignment="Stretch" Tapped="FilterReturnItem_Tapped" Margin="-12,0">
                    <Grid>
                        <TextBlock Margin="36,0,0,0" Text="評級" VerticalAlignment="Center"/>
                        <FontIcon HorizontalAlignment="Left"
                                  Glyph="&#xE0E2;"
                                  FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                  FontSize="12"
                                  AutomationProperties.AccessibilityView="Raw"
                                  Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                                  Margin="0,15,12,17" 
                                  MirroredWhenRightToLeft="True" />
                    </Grid>
                </ListViewItem>

                <CheckBox Content="Safe" IsChecked="{Binding SearchPostFilter.IsFilterSafe, Mode=TwoWay}" 
                          IsEnabled="{Binding SearchPostFilter.IsFilterSafeUnlocked}"/>
                <CheckBox Content="Questionable" IsChecked="{Binding SearchPostFilter.IsFilterQuestionable, Mode=TwoWay}" 
                          IsEnabled="{Binding SearchPostFilter.IsFilterQuestionableUnlocked}"/>
                <CheckBox Content="Explicit" IsChecked="{Binding SearchPostFilter.IsFilterExplicit, Mode=TwoWay}"
                          IsEnabled="{Binding SearchPostFilter.IsFilterExplicitUnlocked}"/>
                <TextBlock Text="All contents are from the Internet and not provided by the developer of this application. Modify these settings only if it is legal in your territory or country. Modify them AT YOUR OWN RISK." TextWrapping="Wrap"/>
            </StackPanel>

        </Flyout>

        <Flyout Placement="Bottom" x:Key="FilterRatioFlyout">
            <Flyout.FlyoutPresenterStyle>
                <Style TargetType="FlyoutPresenter">
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Margin" Value="0"/>
                </Style>
            </Flyout.FlyoutPresenterStyle>


            <StackPanel Width="300" Padding="12,0,12,12">
                <StackPanel.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromHorizontalOffset="56"/>
                    </TransitionCollection>
                </StackPanel.Transitions>

                <ListViewItem HorizontalContentAlignment="Stretch" Tapped="FilterReturnItem_Tapped" Margin="-12,0">
                    <Grid>
                        <TextBlock Margin="36,0,0,0" Text="長闊比" VerticalAlignment="Center"/>
                        <FontIcon HorizontalAlignment="Left"
                Glyph="&#xE0E2;"
                FontFamily="{ThemeResource SymbolThemeFontFamily}"
                FontSize="12"
                AutomationProperties.AccessibilityView="Raw"
                Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                Margin="0,15,12,17" 
                MirroredWhenRightToLeft="True" />
                    </Grid>
                </ListViewItem>

                <CheckBox Content="Horizontal" IsChecked="{Binding SearchPostFilter.IsFilterHorizontal, Mode=TwoWay}" 
                          IsEnabled="{Binding SearchPostFilter.IsFilterHorizontalUnlocked}"/>
                <CheckBox Content="Vertical" IsChecked="{Binding SearchPostFilter.IsFilterVertical, Mode=TwoWay}"
                          IsEnabled="{Binding SearchPostFilter.IsFilterVerticalUnlocked}"/>
                <TextBlock Text="p.s. Square images are treated as horizontal." TextWrapping="Wrap"/>
            </StackPanel>
        </Flyout>

        <Flyout Placement="Bottom" x:Key="FilterHiddenFlyout">

            <Flyout.FlyoutPresenterStyle>
                <Style TargetType="FlyoutPresenter">
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Margin" Value="0"/>
                </Style>
            </Flyout.FlyoutPresenterStyle>


            <StackPanel Width="300" Padding="12,0,12,12">
                <StackPanel.Transitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromHorizontalOffset="56"/>
                    </TransitionCollection>
                </StackPanel.Transitions>

                <ListViewItem HorizontalContentAlignment="Stretch" Tapped="FilterReturnItem_Tapped" Margin="-12,0">
                    <Grid>
                        <TextBlock Margin="36,0,0,0" Text="隱藏圖片" VerticalAlignment="Center"/>
                        <FontIcon HorizontalAlignment="Left"
                                  Glyph="&#xE0E2;"
                                  FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                  FontSize="12"
                                  AutomationProperties.AccessibilityView="Raw"
                                  Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                                  Margin="0,15,12,17" 
                                  MirroredWhenRightToLeft="True" />
                    </Grid>
                </ListViewItem>

                <ToggleSwitch Header="顯示被隱藏的圖片" IsOn="{Binding SearchPostFilter.IsFilterAllowHidden, Mode=TwoWay}"/>
                <TextBlock Text="一般以文字為主的圖片都會被預設隱藏。您可以選擇在搜索結果中顯示它們。" TextWrapping="Wrap"/>
            </StackPanel>
        </Flyout>
    </Page.Resources>


    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="600" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="TabListView.Margin" Value="0,0,12,0"/>
                        <Setter Target="FeatureTextBlock.Visibility" Value="Visible"/>
                        <Setter Target="BrowseTextBlock.Visibility" Value="Visible"/>
                        <Setter Target="FavoriteTextBlock.Visibility" Value="Visible"/>
                        <Setter Target="MoreTextBlock.Visibility" Value="Visible"/>
                        <Setter Target="CurrentHeaderTextBlock.Visibility" Value="Collapsed"/>
                    </VisualState.Setters>
                </VisualState>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="TabListView.Margin" Value="0"/>
                        <Setter Target="FeatureTextBlock.Visibility" Value="Collapsed"/>
                        <Setter Target="BrowseTextBlock.Visibility" Value="Collapsed"/>
                        <Setter Target="FavoriteTextBlock.Visibility" Value="Collapsed"/>
                        <Setter Target="MoreTextBlock.Visibility" Value="Collapsed"/>
                        <Setter Target="CurrentHeaderTextBlock.Visibility" Value="Visible"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>


        </VisualStateManager.VisualStateGroups>

        <Grid Grid.Row="0" 
              Margin="0,-40,0,0" Padding="0,40,0,0" 
               >
            <Grid.Background>
                <SolidColorBrush Color="{ThemeResource SystemAltLowColor}"/>
            </Grid.Background>

            <Grid.BorderBrush>
                <SolidColorBrush Color="White"/>
            </Grid.BorderBrush>

            <Grid.Transitions>
                <TransitionCollection>
                    <!--<EdgeUIThemeTransition/>-->
                    <EntranceThemeTransition FromVerticalOffset="0"/>
                </TransitionCollection>
            </Grid.Transitions>

            <TextBlock x:Name="CurrentHeaderTextBlock" Style="{ThemeResource PageTitleTextBlockStyle}" Text="{Binding SelectedItem.Tag, ElementName=TabListView}" Foreground="White" Visibility="Collapsed"/>

            <ListView x:Name="TabListView" SelectionMode="Single" Margin="0,48,12,0"
                      SelectedIndex="{Binding SelectedViewIndex, Mode=TwoWay}"
                      IsItemClickEnabled="True"
                      HorizontalAlignment="Right"
                      ScrollViewer.VerticalScrollMode="Disabled"
                      RequestedTheme="Light"
                      >
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem" BasedOn="{StaticResource ListViewItemTab}">
                        <Setter Property="BorderBrush" Value="#FF222222"/>
                        <Setter Property="Foreground" Value="#FFFFFFFF"/>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <ItemsStackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>
                <StackPanel Tag="精選" Orientation="Horizontal">
                    <SymbolIcon Symbol="Home" Width="48" />
                    <TextBlock x:Name="FeatureTextBlock" Text="精選" Margin="0,0,16,0"/>
                </StackPanel>
                <StackPanel Tag="瀏覽" Orientation="Horizontal">
                    <SymbolIcon Symbol="BrowsePhotos" Width="48" RenderTransformOrigin="0.5,0.5" >
                        <SymbolIcon.RenderTransform>
                            <CompositeTransform TranslateY="3"/>
                        </SymbolIcon.RenderTransform>
                    </SymbolIcon>
                    <TextBlock x:Name="BrowseTextBlock" Text="瀏覽" Margin="0,0,16,0"/>
                </StackPanel>
                <StackPanel Tag="收藏" Orientation="Horizontal">
                    <SymbolIcon Symbol="OutlineStar" Width="48" />
                    <TextBlock x:Name="FavoriteTextBlock"  Text="收藏" Margin="0,0,16,0"/>
                </StackPanel>
                <StackPanel Tag="更多" Orientation="Horizontal">
                    <SymbolIcon Symbol="More" Width="48" />
                    <TextBlock x:Name="MoreTextBlock" Text="更多" Margin="0,0,16,0"/>
                </StackPanel>
            </ListView>
        </Grid>


        <FlipView x:Name="FlipView" Grid.Row="2" SelectedIndex="{Binding SelectedViewIndex, Mode=TwoWay}" >
            <FlipView.Style>
                <StaticResource ResourceKey="FlipViewStyle1"/>
            </FlipView.Style>
            <!--Feature-->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" Height="48" VerticalAlignment="Top" 
                      BorderThickness="0,0,0,1" 
                      BorderBrush="#FF444444" 
                      Background="#FF222222"
                       >
                    <Grid.Transitions>
                        <TransitionCollection>
                            <EdgeUIThemeTransition/>
                        </TransitionCollection>
                    </Grid.Transitions>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0" VerticalAlignment="Stretch">
                        <Button  Padding="12,0" VerticalAlignment="Stretch">
                            <StackPanel >
                                <TextBlock Text="{x:Bind AppVersion}"/>
                                <TextBlock Text="更新日誌"/>
                            </StackPanel>

                            <Button.Flyout>
                                <Flyout>
                                    <Flyout.FlyoutPresenterStyle>
                                        <Style TargetType="FlyoutPresenter">
                                            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
                                            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Disabled"/>
                                            <Setter Property="Padding" Value="0"/>
                                        </Style>
                                    </Flyout.FlyoutPresenterStyle>

                                    <ListView x:Name="DevLogsListView" SelectionMode="None" ItemsSource="{x:Bind UpdateNotes}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock TextWrapping="Wrap" Margin="0,12" Text="{Binding}" />
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </Flyout>
                            </Button.Flyout>
                        </Button>
                    </StackPanel>


                    <AppBarButton Width="48" HorizontalAlignment="Right" Icon="Refresh" Click="AppBarButton_Click"/>
                </Grid>

                <ScrollViewer Grid.Row="1" Style="{StaticResource ScrollViewerStyleNiceScrollBar}">
                    <local:FeatureView x:Name="FeatureView"/>
                </ScrollViewer>

            </Grid>

            <!--Image Search List-->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>



                <Grid x:Name="BrowseTopSearchBar" Grid.RowSpan="1" Height="48"  
                      VerticalAlignment="Top" HorizontalAlignment="Stretch"
                      BorderThickness="0,0,0,1" 
                      BorderBrush="#FF444444" 
                      Background="#FF222222">
                    <Grid.Transitions>
                        <TransitionCollection>
                            <EdgeUIThemeTransition/>
                        </TransitionCollection>
                    </Grid.Transitions>

                    <AppBarButton x:Name="FilterButton" Width="48" HorizontalAlignment="Left" Icon="Filter" Click="FilterButton_Click" >
                    </AppBarButton>

                    <AutoSuggestBox x:Name="SearchBox" 
                                    QuerySubmitted="SearchBox_QuerySubmitted" QueryIcon="Find" 
                                    TextChanged="SearchBox_TextChanged" 
                                    VerticalAlignment="Center" Margin="52,0,4,0" 
                                    FontSize="18" VerticalContentAlignment="Center" Height="40" 
                                    Loaded="SearchBox_Loaded" Unloaded="SearchBox_Unloaded"
                                    Style="{StaticResource AutoSuggestBoxStyle1}" SuggestionChosen="SearchBox_SuggestionChosen" >
                        <AutoSuggestBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Padding="8" Orientation="Horizontal" Margin="0,4">

                                    <StackPanel.Background>
                                        <SolidColorBrush Color="{Binding Type, Converter={StaticResource TagTypeColorConverter}}"/>
                                    </StackPanel.Background>

                                    <SymbolIcon Symbol="{Binding Type, Converter={StaticResource TagTypeSymbolConverter}}"/>
                                    <TextBlock Text="{Binding Name}" Margin="8,0,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </AutoSuggestBox.ItemTemplate>
                    </AutoSuggestBox>
                </Grid>


                <CommonControls:ImageWall x:Name="BrowseWall" Grid.Row="1" Background="Transparent" DataContext="{Binding BrowsePosts}"
                                HorizontalAlignment="Stretch" ItemClick="ListView_ItemClick" Padding="96,0">

                    <CommonControls:ImageWall.ItemTemplate>
                        <DataTemplate>
                            <UserControl>
                                <Grid Height="{Binding DisplayHeight}" Width="{Binding DisplayWidth}" BorderThickness="0">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup>
                                            <VisualState>
                                                <VisualState.StateTriggers>
                                                    <AdaptiveTrigger MinWindowWidth="500" />
                                                </VisualState.StateTriggers>
                                                <VisualState.Setters>
                                                    <Setter Target="Back.Margin" Value="6"/>
                                                    <Setter Target="Image.Margin" Value="6"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState>
                                                <VisualState.StateTriggers>
                                                    <AdaptiveTrigger MinWindowWidth="0" />
                                                </VisualState.StateTriggers>
                                                <VisualState.Setters>
                                                    <Setter Target="Back.Margin" Value="2"/>
                                                    <Setter Target="Image.Margin" Value="2"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="ImageStates">
                                            <VisualState x:Name="ImageNotLoaded">
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="Image" Storyboard.TargetProperty="Opacity"
                                                     Duration="0" To="0"/>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="ImageLoaded">
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="Image" Storyboard.TargetProperty="Opacity"
                                                     Duration="0:0:0.2" To="1"/>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>

                                    <Rectangle x:Name="Back" VerticalAlignment="Center" HorizontalAlignment="Center"
                                       Stretch="UniformToFill" Margin="2" Fill="{Binding Converter={StaticResource RandomGrayConverter}}"/>

                                    <Border x:Name="Image" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="2" Opacity="0" BorderThickness="1">
                                        <Border.BorderBrush>
                                            <SolidColorBrush Color="#FF222222"/>
                                        </Border.BorderBrush>
                                        <Image Stretch="UniformToFill" Source="{Binding ItemSource.PreviewUrl}" ImageOpened="Image_ImageOpened" HorizontalAlignment="Center" />
                                    </Border>
                                </Grid>
                            </UserControl>
                        </DataTemplate>
                    </CommonControls:ImageWall.ItemTemplate>
                </CommonControls:ImageWall>
            </Grid>


            <!--Favorited Image List-->
            <Grid HorizontalAlignment="Stretch">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" Height="48" VerticalAlignment="Top" 
                      BorderThickness="0,0,0,1" 
                      BorderBrush="#FF444444"
                      Background="#FF222222">
                    <Grid.Transitions>
                        <TransitionCollection>
                            <EdgeUIThemeTransition/>
                        </TransitionCollection>
                    </Grid.Transitions>
                    
                    <StackPanel VerticalAlignment="Stretch" Orientation="Horizontal" Margin="12,0">
                        <TextBlock Text="排序(未完成):" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <ComboBox VerticalAlignment="Center" SelectedIndex="0">
                            <TextBlock Text="Favorite Date"/>
                            <!--<TextBlock Text="Favorite Date (Ord First)"/>
                            <TextBlock Text="Post Date (New Firts)"/>
                            <TextBlock Text="Post Date (Ord First)"/>-->
                        </ComboBox>
                    </StackPanel>

                    <AppBarButton  x:Name="FavoriteRefreshButton" Width="48" HorizontalAlignment="Right" Icon="Refresh" Click="FavoriteRefreshButton_Click" >
                    </AppBarButton>

                </Grid>




                <CommonControls:ImageWall x:Name="FavoriteWall" Grid.Row="1" Background="Transparent" 
                                    HorizontalAlignment="Stretch" ItemClick="ListView_ItemClick" Padding="96,0">
                    <CommonControls:ImageWall.ItemTemplate>
                        <DataTemplate>
                            <UserControl>
                                <Grid Height="{Binding DisplayHeight}" Width="{Binding DisplayWidth}" BorderThickness="0" >

                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup>
                                            <VisualState>
                                                <VisualState.StateTriggers>
                                                    <AdaptiveTrigger MinWindowWidth="500" />
                                                </VisualState.StateTriggers>
                                                <VisualState.Setters>
                                                    <Setter Target="Back.Margin" Value="6"/>
                                                    <Setter Target="Image.Margin" Value="6"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState>
                                                <VisualState.StateTriggers>
                                                    <AdaptiveTrigger MinWindowWidth="0" />
                                                </VisualState.StateTriggers>
                                                <VisualState.Setters>
                                                    <Setter Target="Back.Margin" Value="2"/>
                                                    <Setter Target="Image.Margin" Value="2"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="ImageStates">
                                            <VisualState x:Name="ImageNotLoaded">
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="Image" Storyboard.TargetProperty="Opacity"
                                                     Duration="0" To="0"/>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="ImageLoaded">
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="Image" Storyboard.TargetProperty="Opacity"
                                                     Duration="0:0:0.2" To="1"/>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>



                                    <Rectangle x:Name="Back" VerticalAlignment="Center" HorizontalAlignment="Center"
                                       Stretch="UniformToFill" Margin="2" Fill="{Binding Converter={StaticResource RandomGrayConverter}}"/>

                                    <Border x:Name="Image" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="2" Opacity="0" BorderThickness="1">
                                        <Border.BorderBrush>
                                            <SolidColorBrush Color="#FF222222"/>
                                        </Border.BorderBrush>
                                        <Image Stretch="UniformToFill" Source="{Binding ItemSource.PreviewUrl}" ImageOpened="Image_ImageOpened" HorizontalAlignment="Center" />
                                    </Border>
                                </Grid>
                            </UserControl>
                        </DataTemplate>
                    </CommonControls:ImageWall.ItemTemplate>
                </CommonControls:ImageWall>
            </Grid>


            <!--More items-->
            <Grid >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" Height="48" VerticalAlignment="Top" 
                      BorderThickness="0,0,0,1" 
                      BorderBrush="#FF444444"
                      Background="#FF222222">
                    <Grid.Transitions>
                        <TransitionCollection>
                            <EdgeUIThemeTransition Edge="Top"/>
                        </TransitionCollection>
                    </Grid.Transitions>

                    <!--<AppBarButton  x:Name="FavoriteFilterButton" Width="48" HorizontalAlignment="Left" Icon="Filter" Click="FavoriteFilterButton_Click" >
                    </AppBarButton>-->
                </Grid>

                <ScrollViewer Grid.Row="1" Style="{StaticResource ScrollViewerStyleNiceScrollBar}">
                    <local:AccountView/>
                </ScrollViewer>
            </Grid>
        </FlipView>

    </Grid>
</Page>
